test_duration: 500
prepare_write_cmd:
    - >-
      latte run --function=write --tag=latte-prepare-01
      -P replication_factor=3 --threads=7 --concurrency=21 --consistency=ALL
      -P column_size=1024 -P column_count=1 -P row_count=162500001 -P offset=0
      --sampling=10s --retry-number=10 --retry-interval='500ms,5s' --request-timeout=60
      data_dir/latte/latte_cs_alike.rn
    - >-
      latte run --function=write --tag=latte-prepare-02
      -P replication_factor=3 --threads=7 --concurrency=21 --consistency=ALL
      -P column_size=1024 -P column_count=1 -P row_count=162500001 -P offset=162500001
      --sampling=10s --retry-number=10 --retry-interval='500ms,5s' --request-timeout=60
      data_dir/latte/latte_cs_alike.rn
    - >-
      latte run --function=write --tag=latte-prepare-03
      -P replication_factor=3 --threads=7 --concurrency=21 --consistency=ALL
      -P column_size=1024 -P column_count=1 -P row_count=162500001 -P offset=325000002
      --sampling=10s --retry-number=10 --retry-interval='500ms,5s' --request-timeout=60
      data_dir/latte/latte_cs_alike.rn
    - >-
      latte run --function=write --tag=latte-prepare-04
      -P replication_factor=3 --threads=7 --concurrency=21 --consistency=ALL
      -P column_size=1024 -P column_count=1 -P row_count=162500001 -P offset=487500003
      --sampling=10s --retry-number=10 --retry-interval='500ms,5s' --request-timeout=60
      data_dir/latte/latte_cs_alike.rn

stress_cmd_cache_warmup:
    - >-
      latte run --function=read --tag=latte-main-warmup-01
      -P replication_factor=3 --threads=$threads --concurrency=21 --consistency=QUORUM
      -P column_size=1024 -P column_count=1 -P row_count=5000000 -P offset=0
      --sampling=10s --retry-number=10 --retry-interval='500ms,5s' --request-timeout=60
      data_dir/latte/latte_cs_alike.rn
    - >-
      latte run --function=read --tag=latte-main-warmup-02
      -P replication_factor=3 --threads=$threads --concurrency=21 --consistency=QUORUM
      -P column_size=1024 -P column_count=1 -P row_count=50000 -P offset=50000
      --sampling=10s --retry-number=10 --retry-interval='500ms,5s' --request-timeout=60
      data_dir/latte/latte_cs_alike.rn
    - >-
      latte run --function=read --tag=latte-main-warmup-03
      -P replication_factor=3 --threads=$threads  --concurrency=21 --consistency=QUORUM
      -P column_size=1024 -P column_count=1 -P row_count=50000 -P offset=100000
      --sampling=10s --retry-number=10 --retry-interval='500ms,5s' --request-timeout=60
      data_dir/latte/latte_cs_alike.rn
    - >-
      latte run --function=read --tag=latte-main-warmup-04
      -P replication_factor=3 --threads=$threads --concurrency=21 --consistency=QUORUM
      -P column_size=1024 -P column_count=1 -P row_count=50000 -P offset=150000
      --sampling=10s --retry-number=10 --retry-interval='500ms,5s' --request-timeout=60
      data_dir/latte/latte_cs_alike.rn

stress_cmd_r:
    - >-
      latte run --function=read --tag=latte-main-read-01 --duration=$duration $throttle
      -P replication_factor=3 --threads=$threads --concurrency=21 --consistency=QUORUM
      -P column_size=1024 -P column_count=1 -P row_count=5000000 -P offset=0
      --sampling=10s --retry-number=10 --retry-interval='500ms,5s' --request-timeout=60
      data_dir/latte/latte_cs_alike.rn
    - >-
      latte run --function=read --tag=latte-main-read-02 --duration=$duration $throttle
      -P replication_factor=3 --threads=$threads --concurrency=21 --consistency=QUORUM
      -P column_size=1024 -P column_count=1 -P row_count=50000 -P offset=50000
      --sampling=10s --retry-number=10 --retry-interval='500ms,5s' --request-timeout=60
      data_dir/latte/latte_cs_alike.rn
    - >-
      latte run --function=read --tag=latte-main-read-03 --duration=$duration $throttle
      -P replication_factor=3 --threads=$threads  --concurrency=21 --consistency=QUORUM
      -P column_size=1024 -P column_count=1 -P row_count=50000 -P offset=100000
      --sampling=10s --retry-number=10 --retry-interval='500ms,5s' --request-timeout=60
      data_dir/latte/latte_cs_alike.rn
    - >-
      latte run --function=read --tag=latte-main-read-04 --duration=$duration $throttle
      -P replication_factor=3 --threads=$threads --concurrency=21 --consistency=QUORUM
      -P column_size=1024 -P column_count=1 -P row_count=50000 -P offset=150000
      --sampling=10s --retry-number=10 --retry-interval='500ms,5s' --request-timeout=60
      data_dir/latte/latte_cs_alike.rn

stress_cmd_m:
    - >-
      latte run --function=write,read --tag=latte-main-mixed-01 --duration=$duration $throttle
      -P replication_factor=3 --threads=$threads --concurrency=21 --consistency=QUORUM
      -P column_size=1024 -P column_count=1 -P row_count=5000000 -P offset=0
      --sampling=10s --retry-number=10 --retry-interval='500ms,5s' --request-timeout=60
      data_dir/latte/latte_cs_alike.rn
    - >-
      latte run --function=write,read --tag=latte-main-mixed-02 --duration=$duration $throttle
      -P replication_factor=3 --threads=$threads --concurrency=21 --consistency=QUORUM
      -P column_size=1024 -P column_count=1 -P row_count=5000000 -P offset=5000000
      --sampling=10s --retry-number=10 --retry-interval='500ms,5s' --request-timeout=60
      data_dir/latte/latte_cs_alike.rn
    - >-
      latte run --function=write,read --tag=latte-main-mixed-03 --duration=$duration $throttle
      -P replication_factor=3 --threads=$threads --concurrency=21 --consistency=QUORUM
      -P column_size=1024 -P column_count=1 -P row_count=5000000 -P offset=10000000
      --sampling=10s --retry-number=10 --retry-interval='500ms,5s' --request-timeout=60
      data_dir/latte/latte_cs_alike.rn
    - >-
      latte run --function=write,read --tag=latte-main-mixed-04 --duration=$duration $throttle
      -P replication_factor=3 --threads=$threads --concurrency=21 --consistency=QUORUM
      -P column_size=1024 -P column_count=1 -P row_count=5000000 -P offset=15000000
      --sampling=10s --retry-number=10 --retry-interval='500ms,5s' --request-timeout=60
      data_dir/latte/latte_cs_alike.rn

stress_cmd_w:
    - >-
      latte run --function=write --tag=latte-main-write-01 $throttle
      -P replication_factor=3 --threads=$threads --concurrency=21 --consistency=QUORUM
      -P column_size=1024 -P column_count=1 -P row_count=402653184 -P offset=0
      --sampling=10s --retry-number=10 --retry-interval='500ms,5s' --request-timeout=60
      data_dir/latte/latte_cs_alike.rn
    - >-
      latte run --function=write --tag=latte-main-write-02 $throttle
      -P replication_factor=3 --threads=$threads --concurrency=21 --consistency=QUORUM
      -P column_size=1024 -P column_count=1 -P row_count=402653184 -P offset=402653184
      --sampling=10s --retry-number=10 --retry-interval='500ms,5s' --request-timeout=60
      data_dir/latte/latte_cs_alike.rn
    - >-
      latte run --function=write --tag=latte-main-write-03 $throttle
      -P replication_factor=3 --threads=$threads --concurrency=21 --consistency=QUORUM
      -P column_size=1024 -P column_count=1 -P row_count=402653184 -P offset=805306368
      --sampling=10s --retry-number=10 --retry-interval='500ms,5s' --request-timeout=60
      data_dir/latte/latte_cs_alike.rn
    - >-
      latte run --function=write --tag=latte-main-write-04 $throttle
      -P replication_factor=3 --threads=$threads --concurrency=21 --consistency=QUORUM
      -P column_size=1024 -P column_count=1 -P row_count=402653184 -P offset=1207959552
      --sampling=10s --retry-number=10 --retry-interval='500ms,5s' --request-timeout=60
      data_dir/latte/latte_cs_alike.rn

round_robin: true

n_db_nodes: 3
n_loaders: 4
n_monitor_nodes: 1

instance_type_db: 'i4i.4xlarge'
instance_type_loader: 'c7i.8xlarge'
instance_type_monitor: 't3.small'
use_capacity_reservation: true
nemesis_add_node_cnt: 0

use_preinstalled_scylla: true

user_prefix: 'perf-regression-predefined-steps'

backtrace_decoding: false

store_perf_results: true
use_mgmt: false
email_recipients: ['scylla-perf-results@scylladb.com']

custom_es_index: 'performancestatsv2'
use_hdrhistogram: true

append_scylla_args: '--blocked-reactor-notify-ms 5 --abort-on-lsa-bad-alloc 1 --abort-on-seastar-bad-alloc --abort-on-internal-error 1 --abort-on-ebadf 1'
append_scylla_yaml:
  auto_snapshot: false

use_placement_group: true
use_prepared_loaders: false
#stress_image:
#  cassandra-stress: 'scylladb/cassandra-stress:3.17.5'
